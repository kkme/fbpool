<?xml version="1.0"?>

<project default="fb:build"
    xmlns:j="jelly:core"
    xmlns:ant="jelly:ant"
    xmlns:maven="jelly:maven"
    xmlns:x="jelly:xml">
    
  <goal name="fb:build">
    <j:set var="goal" value="fb:build"/>
    <attainGoal name="multiproject:goal"/>
  </goal>

  <goal name="fb:clean" prereqs="multiproject:clean,clean"/>
  
  <goal name="fb:generate" prereqs="multiproject:projects-init">
    <ant:mkdir dir="${maven.build.dir}"/>
    <maven:get var="multiprojects" plugin="maven-multiproject-plugin" property="multiprojects"/>
    <j:file name="${maven.build.dir}/projects.xml" prettyPrint="true" xmlns="projects">
      <projects>
        <j:forEach var="project" items="${multiprojects}">
          <x:element name="project">
            <x:attribute name="name">${project.name}</x:attribute>          
            <x:attribute name="artifactId">${project.artifactId}</x:attribute>          
          </x:element>        
        </j:forEach>
      </projects>
    </j:file>
  </goal>

</project>

